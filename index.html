<!DOCTYPE html>
<html>

<head>
	<title>Week 3 - Hangman Game</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Hangman Game">
    <meta name="author" content="Ali Zaidi">

	<!-- set up style sheets -->
	<!-- reset not needed because using bootstrap -->
	<!-- <link rel="stylesheet" type="text/css" href="/assets/css/reset.css"> -->
	<!-- Link in locally stored min version of bootstrap.css -->
	<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css">
	<!-- Make final css adjustments with personal stylesheet -->
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">
</head>

<body>

	<!-- This is what will be initially displayed on the screen -->
	<div id="instructions">
		<p>This is where the instructions will go</p>
	</div>
	<div id="game">
		<p>This is where game progress will go</p>
	</div>
	<div id="stats">
		<p>This is where wins and losses counter will go</p>
	</div>


	<script type="text/javascript">

		// Define words that can computer will select from
		var wordsList = ["homer simpson", "bart simpson", "marge simpson", "mr burns", "lisa simpson", "ned flanders", "moe szyslak", "barnie gumble", "comic book guy", "chief wiggum", "nelson muntz", "martin prince"];

		// Define alphabet letters that user can pick from
		var alphabetLetters = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"];

		// Set the initial global variables
		var wins = 0;
		var losses = 0;
		// guessesLeft is how many attempts user has remaining in the round
		var guessesLeft = 13;
		// guessesSoFar is an array that will hold all the user's guesses in each round
		var guessesSoFar = [];
		// userGuess is what the user picks by pressing a key
		var userGuess = null;
		// Have computer pick a word and store it in wordToBeGuessed
		var wordToBeGuessed = wordsList[Math.floor(Math.random() * wordsList.length)];
		// arrayFromWord is an array that will hold the letters of the wordToBeGuessed
		var arrayFromWord = [];
		// html is what will be populated back into the html from the javascript
		var html = "";

		// rip the wordToBeGuessed apart into an array such that each character is one
		// array element followed by false as the next element then the second character
		// then the element false, and so on. For example:
		// if the word was "hi" then array would be ["h", false, "i", false]
		// However, if the character is a space then the next element should be true
		// first define the function (for later reuse) then call it right away
		function breakWordIntoArray() {
			for (var i = 0, j = 0; i < wordToBeGuessed.length; i++) {
				arrayFromWord[j] = wordToBeGuessed.charAt(i);
				j++
				if (wordToBeGuessed.charAt(i) != " ") {
					arrayFromWord[j] = false;
				} else {
					arrayFromWord[j] = true;
				}
				j++
			}
		}
		// now that function has been defined, let's call it
		breakWordIntoArray();

		// function to help with console logging various variables
		function consoleLogs() {
			console.log("wins: " + wins + "\n" + "losses: " + losses + "\n");
			console.log("guessesLeft: " + guessesLeft + "\n");
			console.log("guessesSoFar: " + guessesSoFar + "\n");
			console.log("wordToBeGuessed: " + wordToBeGuessed + "\n");
			console.log("arrayFromWord: " + arrayFromWord + "\n");
			console.log("html: " + html + "\n");
			console.log("--------------------------------");
		}

		function resetGame() {
			guessesLeft = 13;
			guessesSoFar = [];
			wordToBeGuessed = wordsList[Math.floor(Math.random() * wordsList.length)];
			arrayFromWord = [];
			breakWordIntoArray();
			var htmlInstructions="Press any key to begin guessing";
			document.querySelector("#instructions").innerHTML = htmlInstructions;
			var htmlGameInitial = "";
			for (var i = 0; i < wordToBeGuessed.length; i++) {
				htmlGameInitial += "_ ";
			}
			document.querySelector("#game").innerHTML = htmlGameInitial;
			var htmlStats = "Wins: " + wins + " Losses: " + losses + " Guesses Left : " + guessesLeft;
			document.querySelector("#stats").innerHTML = htmlStats;

		}

		resetGame()

		// debugging
		consoleLogs();

		// start listening for events
		document.onkeyup = function(event) {

			// When user presses a key, it records it and saves to userGuess
			userGuess = String.fromCharCode(event.keyCode).toLowerCase();

			// if user enters a valid letter, then check:
			// if the user pick doesn't exit in the array of prior picks &
			// it also doesn't exist in the array of the letters of the word
			// to be guess, then add the letter to the prior guesses array
			// and also reduce the guesses left by one
			if (arrayFromWord.indexOf(userGuess) < 0 && guessesSoFar.indexOf(userGuess) < 0 && alphabetLetters.indexOf(userGuess) >= 0) {
				guessesSoFar[guessesSoFar.length]=userGuess;
				guessesLeft--;
				var audio = new Audio("assets/audio/doh1.mp3");
				audio.play();
			}

			// if userGuess exists in the array then switch its associated
			// array pair from false to true
			for (var i = 0; i < arrayFromWord.length; i++) {
				if (arrayFromWord[i] == userGuess) {
					arrayFromWord[i+1] = true;
					var audio = new Audio("assets/audio/woohoo.mp3");
					audio.play();
				}
			}

			// Displaying progress to HTML
			// Display arrayFromWord by building html for it
			// html begins with a non space character otherwise getting
			// undefined as first character when building the array
			// set variable html for output display
			for (i = 0, j = 0; i < (arrayFromWord.length / 2); i++) {
					if (arrayFromWord[j+1] == true) {
					html += arrayFromWord[j];
				} else {
					html += "_";
				}
				html += "&nbsp;";
				j=j+2;
			}

			// place html into the game ID
			document.querySelector("#game").innerHTML = html;
			htmlStats = "Wins: " + wins + " Losses: " + losses + " Guesses Left : " + guessesLeft;
			document.querySelector("#stats").innerHTML = htmlStats;

			// debugging
			consoleLogs();

			// reset the html variable so we can rebuild it after next user guess
			html="";

			// check to see if user has won which will mean all the
			// letters have been revealed, or that no false flags remain
			if (arrayFromWord.indexOf(false) < 0 ) {
				console.log("USER WINS");
				wins++;
				var audio = new Audio("assets/audio/champion.mp3");
				audio.play();
				resetGame();
			}

			// check to see if user has lost which will mean guessesLeft = 0
			if (guessesLeft == 0) {
				console.log("USER LOSES");
				losses++;
				var audio = new Audio("assets/audio/crap.mp3");
				audio.play();
				resetGame();
			}

			// debugging
			consoleLogs();
		}
		// end listening for events

	</script>

</body>

</html>